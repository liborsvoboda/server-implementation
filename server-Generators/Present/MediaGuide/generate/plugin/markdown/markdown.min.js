(function(n,t){typeof define=="function"&&define.amd?(n.marked=require("./marked"),n.RevealMarkdown=t(n.marked),n.RevealMarkdown.initialize()):typeof exports=="object"?module.exports=t(require("./marked")):(n.RevealMarkdown=t(n.marked),n.RevealMarkdown.initialize())})(this,function(n){function t(n){var f=n.querySelector("script"),t=(f||n).textContent,i,r;return t=t.replace(new RegExp(u,"g"),"<\/script>"),i=t.match(/^\n?(\s*)/)[1].length,r=t.match(/^\n?(\t*)/)[1].length,r>0?t=t.replace(new RegExp("\\n?\\t{"+r+"}","g"),"\n"):i>1&&(t=t.replace(new RegExp("\\n? {"+i+"}","g"),"\n")),t}function f(n){for(var i,f,r=n.attributes,u=[],t=0,e=r.length;t<e;t++)(i=r[t].name,f=r[t].value,/data\-(markdown|separator|vertical|notes)/gi.test(i))||(f?u.push(i+'="'+f+'"'):u.push(i));return u.join(" ")}function e(n){return n=n||{},n.separator=n.separator||l,n.notesSeparator=n.notesSeparator||a,n.attributes=n.attributes||"",n}function i(t,i){i=e(i);var r=t.split(new RegExp(i.notesSeparator,"mgi"));return r.length===2&&(t=r[0]+'<aside class="notes">'+n(r[1].trim())+"<\/aside>"),t=t.replace(/<\/script>/g,u),'<script type="text/template">'+t+"<\/script>"}function r(n,t){var u,f,v;t=e(t);for(var a=new RegExp(t.separator+(t.verticalSeparator?"|"+t.verticalSeparator:""),"mg"),y=new RegExp(t.separator),h,c=0,o,s=!0,l,r=[];h=a.exec(n);)notes=null,o=y.test(h[0]),!o&&s&&r.push([]),l=n.substring(c,h.index),o&&s?r.push(l):r[r.length-1].push(l),c=a.lastIndex,s=o;for((s?r:r[r.length-1]).push(n.substring(c)),u="",f=0,v=r.length;f<v;f++)r[f]instanceof Array?(u+="<section "+t.attributes+">",r[f].forEach(function(n){u+="<section data-markdown>"+i(n,t)+"<\/section>"}),u+="<\/section>"):u+="<section "+t.attributes+" data-markdown>"+i(r[f],t)+"<\/section>";return u}function o(){for(var u,e,s=document.querySelectorAll("[data-markdown]"),n,o=0,h=s.length;o<h;o++)if(n=s[o],n.getAttribute("data-markdown").length){u=new XMLHttpRequest;e=n.getAttribute("data-markdown");datacharset=n.getAttribute("data-charset");datacharset!=null&&datacharset!=""&&u.overrideMimeType("text/html; charset="+datacharset);u.onreadystatechange=function(){u.readyState===4&&(n.outerHTML=u.status>=200&&u.status<300||u.status===0?r(u.responseText,{separator:n.getAttribute("data-separator"),verticalSeparator:n.getAttribute("data-separator-vertical"),notesSeparator:n.getAttribute("data-separator-notes"),attributes:f(n)}):'<section data-state="alert">ERROR: The attempt to fetch '+e+" failed with HTTP status "+u.status+".Check your browser's JavaScript console for more details.<p>Remember that you need to serve the presentation HTML from a HTTP server.<\/p><\/section>")};u.open("GET",e,!1);try{u.send()}catch(c){alert("Failed to get the Markdown file "+e+". Make sure that the presentation and the file are served by a HTTP server and the file can be found there. "+c)}}else n.getAttribute("data-separator")||n.getAttribute("data-separator-vertical")||n.getAttribute("data-separator-notes")?n.outerHTML=r(t(n),{separator:n.getAttribute("data-separator"),verticalSeparator:n.getAttribute("data-separator-vertical"),notesSeparator:n.getAttribute("data-separator-notes"),attributes:f(n)}):n.innerHTML=i(t(n))}function s(n,t,i){var u=new RegExp(i,"mg"),e=new RegExp('([^"= ]+?)="([^"=]+?)"',"mg"),r=n.nodeValue,f;if(matches=u.exec(r)){for(f=matches[1],r=r.substring(0,matches.index)+r.substring(u.lastIndex),n.nodeValue=r;matchesClass=e.exec(f);)t.setAttribute(matchesClass[1],matchesClass[2]);return!0}return!1}function h(n,t,i,r,u){if(t!=null&&t.childNodes!=undefined&&t.childNodes.length>0){previousParentElement=t;for(var f=0;f<t.childNodes.length;f++){if(childElement=t.childNodes[f],f>0)for(j=f-1;j>=0;){if(aPreviousChildElement=t.childNodes[j],typeof aPreviousChildElement.setAttribute=="function"&&aPreviousChildElement.tagName!="BR"){previousParentElement=aPreviousChildElement;break}j=j-1}parentSection=n;childElement.nodeName=="section"&&(parentSection=childElement,previousParentElement=childElement);(typeof childElement.setAttribute=="function"||childElement.nodeType==Node.COMMENT_NODE)&&h(parentSection,childElement,previousParentElement,r,u)}}t.nodeType==Node.COMMENT_NODE&&s(t,i,r)==!1&&s(t,n,u)}function c(){for(var i,u,e,f=document.querySelectorAll("[data-markdown]"),r=0,o=f.length;r<o;r++)i=f[r],i.getAttribute("data-markdown-parsed")||(i.setAttribute("data-markdown-parsed",!0),u=i.querySelector("aside.notes"),e=t(i),i.innerHTML=n(e),h(i,i,null,i.getAttribute("data-element-attributes")||i.parentNode.getAttribute("data-element-attributes")||v,i.getAttribute("data-attributes")||i.parentNode.getAttribute("data-attributes")||y),u&&i.appendChild(u))}if(typeof n=="undefined")throw"The reveal.js Markdown plugin requires marked to be loaded";typeof hljs!="undefined"&&n.setOptions({highlight:function(n,t){return hljs.highlightAuto(n,t).value}});var l="^\r?\n---\r?\n$",a="note:",v="\\.element\\s*?(.+?)$",y="\\.slide:\\s*?(\\S.+?)$",u="__SCRIPT_END__";return{initialize:function(){o();c()},processSlides:o,convertSlides:c,slidify:r}});